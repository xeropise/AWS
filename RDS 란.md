### [Amazon RDS](https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/Welcome.html)란

![AWS-Feature](https://user-images.githubusercontent.com/50399804/134775169-04a5d733-e23b-4bbb-a2f9-6099aca4a4a7.png)

- Amazon Relational Database Service(Amazon RDS)는 관계형 데이터베이스 6종류의 제품을 클라우드에 최적화된 상태로 제공하는 서비스이다.

- Amazon Aurora 외에도 PostgreSQL, MySQL, MariaDB, Oracle Dtabase, SQL Server 를 지원하며 메모리, 성능, I/O 등이 최적화된 데이터베이스 인스턴스를 제공한다.

- 데이터베이스의 제공 방식은 EC2와 비슷하다. VPC 상에 인스턴스 형태로 구축하며 다양한 인스턴스 클래스를 사용할 수 있다.

  - EC2와 다른 점은 RDS는 '매니지드 서비스' 이며 업데이트 등의 관리가 AWS에 의해 자동으로 이루어진다는 점이다.

  - 백업과 같이 번거로운 관리 작업도 자동화되어 있어 관리자가 수행할 필요가 없다.

- AWS Database Migration Server(DMS) 를 사용하면 기존 데이터베이스를 이전하거나 복제하는 것도 가능하다.

<br>

---

### 인스턴스 클래스

- RDS는 EC2와 마찬가지로 인스턴스 형식으로 사용하는데 인스턴스 클래스는 표준, 메모리 최적화, 버스트 성능의 3종류가 있다.

- 클래스에 따라 micro, small, medium, large, xlarge, 2xlarge, 4xlarge, 8xlarge, 16xlarge 크기를 제공하고 있다. 인스턴스 클래스에 따라 지원하지 않는 DBMS나 버전도 있다.

- 데이터베이스 인스턴스는 VPC에 설치해야 한다. 예전에 데이터베이스 인스턴스는 VPC 외부에도 설치할 수 있었지만, 지금은 VPC에 설치하지 않으면 안 된다.

- 자세한 것은 [여기](https://aws.amazon.com/ko/rds/instance-types/)에서 참조하자.

| 용도         | 인스턴스 클래스 | 내용                                                                                                                           |
| ------------ | --------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| 표준         | db.m5 등        | 범용적인 인스턴스 클래스                                                                                                       |
| 메모리최적화 | db.x1e          | 메모리를 많이 사용하는 애플리케이션에 최적화된 인스턴스 클래스로, 일부 리전에서만 제공된다.<br>한국 리전에서는 이용할 수 있다. |
|              | db.x1           | 메모리를 많이 사용하는 애플리케이션에 최적화된 인스턴스 클래스이다. 메모리 최대치가 db.x1e의 절반                              |
|              | db.r5 등        | 네트워크와 EBS의 성능을 강화한다. AWS Nitro System 을 사용한다.                                                                |
| 버스트 성능  | db.t3           | CPU의 최대 사용률까지 버스트 성능으로 사용할 수 있다.                                                                          |

<br>

---

### RDS 요금

- 기본적으로 EC2 와 비슷하지만, DBMS에 따라 인스턴스 요금이 다른 것이 특징이다. DBMS는 무료와 유료가 있고, 유료 DBMS는 AWS 에서도 라이선스 사용료가 부과된다. 라이선스 요금은 인스턴스 요금에 포함되어 있다.
  - RDS 요금 = 스토리지(사용하고 있는 디스크) 요금 + 데이터베이스 인스턴스 요금 + 백업 스토리지 요금 + 통신료

<br>

---

### RDS의 장점과 단점

- RDS의 장점

  - 매니지드 서비스이므로 AWS가 업데이트 등을 관리해주기 때문에 따로 관리하지 않아도 된다.

  - 간단하게 데이터베이스를 생성할 수 있으며 온프레미스에서 데이터를 이전하기 쉽고 소프트웨어를 수정하지 않아도 이전이 가능하다.

  - EC2 와 연동하기 쉽고 같은 네트워크 내에 있다면 통신료도 무료이다.

- RDS의 단점

  - 사용자가 자유롭게 사용할 수 없다.

  - 제공하고 있는 DBMS의 종류나 버전이 한정되어 있으며, AWS가 업데이트를 자동으로 수행하여 편리하지만 오히려 업데이트하면 곤란한 시점에 수행되는 경우도 있다.

> RDS의 자동 업데이트 ?
>
> - 새로운 버전이 출시되거나 소프트웨어 취약점이 발견된 경우에는 자동으로 업데이트된다.
>
> - 예고 없이 갑자기 업데이트한다면 당연히 곤란하기 때문에 서비스 정지가 필요할 경우에는 AWS에서 따로 공지하는데 세가지 중 하나를 선택한다.
>
>   - 자동 업데이트를 하는 방법, 테스트 환경으로 사용할 경우는 별로 영향이 없을 지도 모르지만 그래도 싫어하는 사람이 있을 수 있다.
>
>   - 관리 콘솔에서 수동으로 업데이트하거나 업데이트 시간을 지정하는 방법, 업데이트 시에 일시적으로 데이터베이스 인스턴스를 사용할 수 없다. 관리자가 모르는 사이에 업데이트되는 것을 방지할 수 있고, 사전에 사이트 사용자와 시스템 사용자에게 공지할 수 있다.
>
>   - 업데이트를 무시하는 방법, 치명적인 취약점에 대한 업데이트는 무시하기 힘들고 오래된 버전은 AWS가 점점 지원을 종료하므로 어느 시점에는 업데이트를 해야 한다. 업데이트를 하지 않는 선택은 문제를 미루는 것에 불과하므로 아예 하지 않는 선택지는 없다고 생각하자.



<br>



***

### RDS에서 사용할 수 있는 DBMS: 데이터베이스 엔진 선택

- RDS는 AWS가 만든 Amazon Aurora 외에도 PostgreSQL, MySQL, MariaDB, Oracle Database, SQL Server 등 데이터베이스 엔진 6 종류를 사용할 수 있다.

  

- 온프레미스에서  AWS로 쉽게 이전할 수 있고 상용 데이터베이스(SQL Server, Oracle Database) 도 지원 한다.  상용 데이터베이스의 경우 데이터베이스 라이선스 요금이 인스턴스 사용 요금에 포함되어 있다. 요금 체계가 단순하다는 저도 장점이다.



<br>



***

### 지원하는 DBMS 목록

| DBMS (제공사)                                        | 내용                                                         |
| ---------------------------------------------------- | ------------------------------------------------------------ |
| Amazon Aurora <br>(Amazon)                           | MySQL 이나 PostgreSQl 과 호환할 수 있다. AWS가 만든 RDBMS 이다. |
| PostgreSQL<br> (PostgreSQL Global Development Group) | 1970년대에 개발한 Ingress 라는 데이터베이스로부터 만들어진 오픈소스 데이터베이스이다.<br> MySQl과 마찬가지로 블로그를 비롯하여 쇼핑몰 사이트까지 폭넓게 사용되고 있다. |
| MySQL<br>(Oracle)                                    | 스웨덴의 MySQl AB가 개발한 데이터베이스로, 썬 마이크로 시스템에 매수되었다. <br>오픈소스 RDBMS 중에 인기가 많은 편이다. |
| MariaDB<br>(Monty Program Ab)                        | MySQL 개발자가 독립적으로 분리하여 개발한 데이터베이스로 기능은 MySQL과 거의 같지만,<br>라이선스가 <u>GPL</u> 이라는 점이 다르다. |
| Oracle Database<br>(Oracle)                          | 오라클이 제공하는 데이터베이스로 소규모 시스템부터 엔터파이즈 시스템까지 폭넓게 지원하는 데이터베이스이며, 즈우건이나 금융 시스템에서 많이 사용되고 있다. 윈도우는 물론 리눅스에서도 동작한다. |
| Microsoft <br>SQL Server<br>(Microsoft)              | 마이크로소프트가 제공하는 데이터베이스, 소규모 시스템부터 엔터프라이즈 시스템까지 폭넓게 지원한다.<br>원래는 윈도우 서버용 소프트웨어였지만 현재는 리눅스에서도 동작한다. |



> GPL
>
> - General Public License의 약자로 소프트웨어 개발자가 정해 놓은 사용 방법으로, 조건 안에서 사용하는 것을 전제로 무료로 사용할 수 있는 라이선스



<br>



### Amazon Aurora란?

- MySQl 이나 PostgreSQL 과 호환할 수 있으며, AWS가 만든 RDBMS를 말한다. 요금이 조금 비싼 편이지만 견고하고 성능이 뛰어나다.

  

- 호환성을 가지고 있기 때문에 일반적인 도구나 스냅샷을 사용하여 온프레미스 환경의 MySQL이나 PostgreSQl 을 이전할 수 있고, SQL 문도 그대로 사용할 수 있으며, 코드 , 애플리케이션, 드라이버, 도구 등의 프로그램 및 소프트웨어를 수정할 필요도 없다.

  

- AWS 용으로 설계되어 있기 때문에 일반적인 MySQL 이나 PostgerSQL 데이터베이스에 비해 속도가 빠르다. 매니지드 서비스이며 안전하게 사용할 수 있다.



- AWS에서 MySQL 이나 PostgreSQL 을 사용하는 방법은 3가지 이다.

  - EC2에 설치하는 방법

    

  - RDS를 사용하는 방법

    

  - Amazon Aurora 를 사용하는 방법

    

- Amazon Aurora 의 경우, DBMS 를 변경할 때 큰 문제가 없고, 높은 성능을 원할 경우에 사용을 추천한다.

  

- RDS로 이전할 때 최신 버전이나 평가판, 이전 버전은 지원하지 않을 가능성이 있으므로 이럴 경우에는 EC2에 MySQL 이나 PostgreSQL 을 설치하여 이전한다.



<br>



***

### RDS 사용 절차: 데이터베이스를 사용하기까지의 절차



#### RDS조작

- EC2와 마찬가지로 데이터베이스 작업은 '데이터베이스 준비' 와 '데이터베이스 사용' 으로 나누어진다.

  - 데이터베이스 준비 작업은 데이터베이스를 만들거나 설정하는 등의 조작을 말한다. 이러한 작업은 관리 콘솔에서 이루어진다.

    

  - 데이터베이스 사용 작업은 데이터를 입력, 삭제, 변경하는 조작을 말하는데 데이터베이스 클라이언트(관리도구)나 소프트웨어(애플리케이션)을 통해 이루어진다.

    

- RDS의 경우 소프트웨어가 EC2에 설치되어 있는 경우가 많고, 연동해서 사용한다.

  - 예로 워드프레스인 경우, EC2에 워드프레스 애플리케이션을 설치하고, 데이터베이스는 RDS로 구축한다.



<br>



#### RDS 서비스의 기능

- RDS 는 데이터베이스 서비스이므로 설정할 수 있는 항목이 여러가지이다.

  1. 데이터베이스 엔진 항목

     - 어떤 DBMS 를 사용할 것인지 정해야 한다. 또한, AWS가 지원하는 버전과 지원하지 않는 버전이 있다.

       

     - 대부분의 데이터베이스는 소프트웨어와 연동해서 사용하기 때문에 같이 사용할 소프트웨어를 지원하는 DBMS 버전이 무엇인지 알아 두어야 한다. 

     | 항목                   | 의미                                                         |
     | ---------------------- | ------------------------------------------------------------ |
     | 데이터베이스 엔진      | DBMS의 종류를 말한다.                                        |
     | 템플릿                 | 프로덕선 환경인지, 개발/테스트 환경인지를 표현한다. <br>프로덕션 환경을 선택하면 다중 AZ가 기본으로 활성화되는 등 해당 환경에 관한 설정이 표시된다. |
     | 라이선스 모델          | GPL을 포함하여 라이선스 모델이 여러 개인 경우는 선택한다.    |
     | 데이터베이스 엔진 버전 | 버전이 여러 개인 경우는 선택한다.                            |

     <br>

     

     > [AZ](https://goddaehee.tistory.com/178)?

     

  2. 데이터베이스 인스턴스 항목

     - 온프레미스 환경의 물리적인 서버에 해당하는 항목이다.

       

     - 사용할 수 있는 예산과 관련되기 때문에 요금과 기대 효과를 고려하여 필요한 사양을 선택해야 한다.

       

     - 다중 AZ나 스케일링은 데이터베이스 규모와 중요도와 맞게 선택한다. 테스트용으로 사용할 경우, 지워져서는 안 되는 데이터라면 불필요하겠지만 이중화를 설정해야 한다.

     | 항목                         | 의미                                                         |
     | ---------------------------- | ------------------------------------------------------------ |
     | 인스턴스 클래스              | 데이터베이스 인스턴스의 사양을 말한다.                       |
     | 다중 AZ 배포                 | 2개 이상의 AZ에 배포하여 이중화 구성 여부를 설정한다.        |
     | 스토리지 유형                | 스토리지 종류이다.                                           |
     | 스토리지 할당                | 스토리지의 용량이다.                                         |
     | 자동 스케일링                | 스토리지가 부족할 때 자동으로 늘릴지 여부를 설정한다.        |
     | 스케일링 임계 값             | 자동 스케일링의 임계 값이다.                                 |
     | 데이터베이스 클러스터 식별자 | AWS에서 데이터베이스 클러스터를 관리하기 위한 이름으로, 데이터 베이스명이 아니므로 주의해야 한다. |
     | 마스터 사용자명              | 데이터베이스 인스턴스의 관리자 권한을 가진 사용자명이다. 임의로 설정한다. |
     | 마스터 사용자 암호           | 데이터베이스 인스턴스의 관리자 암호이다. 임의로 설정한다.    |

     <br>

     

  3. 네트워크 항목

     - RDS 인스턴스는 반드시 VPC에 설치해야 한다. 

       

     - EC2와 연동하려면 EC2가 사용하고 있는 서브넷 그룹 및 가용 영역을 확인해야 한다. 보안 그룹도 미리 생성해 두면 좋다.

     | 항목               | 의미                                                         |
     | ------------------ | ------------------------------------------------------------ |
     | VPC                | RDS를 설치할 VPC로, VPC의 생성은 VPC 대시보드에서 수행한다.  |
     | 서브넷 그룹        | RDS를 설치할 서브넷 그룹으로 EC2 인스턴스와 연동할 경우, 동일한 곳에 설치하는 것이 일반적이다. |
     | 퍼블릭 액세스 기능 | 데이터베이스 인스턴스에 공인 IP 주소를 할당한지 여부를 나타낸다. <br>같은 VPC 내의 서비스가 아닌 곳에서 데이터베이스에 직접 접속할 경우에도 필요하다. |
     | 가용 영역          | RDS를 설치할 가용 영역이다. EC2 인스턴스와 연동할 경우, 동일한 곳에 설치하는 것이 일반적이다.<br>(사전에 정보를 알아 두어야 한다.) |
     | 보안 그룹          | 인스턴스 단위로 설정하는 방화벽으로 사용할 포트를 열지 않으면 통신이 안 되므로 주의하자.<br>보안 그룹이 없으면 미리 만들어 두자. 설정하면서 생성도 가능하다. |

     <br>

     

  4. 데이터베이스 환경 항목

     - 데이터베이스별로 환경을 설정할 수 있다. 유지 보수와 관련된 설정이 많으므로 운영을 고려하여 설정하는 것이 좋다.

     | 항목                       | 의미                                                         |
     | -------------------------- | ------------------------------------------------------------ |
     | 데이터베이스명             | 데이터베이스 이름이다.                                       |
     | 포트                       | 사용할 포트로 1433(SQL Server), 3306(My SQL), 5432(PostgreSQL), 5439(Redshift), 1521(Oracle Database) |
     | 데이터베이스 파라미터 그룹 | 환경 설정을 위한 옵션으로 대부분의 경우 기본 설정을 사용한다. |
     | 옵션 그룹                  | 추가 기능에 대한 설정으로 대부분의 경우 기본 설정을 사용한다. |
     | 암호화                     | 암호화 여부를 나타낸다. 인스턴스의 종류에 따라서 사용할 수 없는 경우도 있다. |
     | 백업                       | 자동으로 생성된 백업의 보존 기간을 말한다.                   |
     | 모니터링                   | 데이터베이스 인스턴스를 모니터링하는 방법이다.<br> '확장 모니터링'을 활성화하면 좀 더 상세한 정보를 얻을 수 있지만 요금이 부과된다. |
     | 로그 내보내기              | Amazon CloudWatch Logs 를 사용하여 로그를 출력한다.          |
     | 유지 관리                  | 자동 업데이트에 대한 방법과 시간대를 설정한다.               |
     | 삭제 방지                  | 삭제되지 않도록 보호 여부를 나타낸다.                        |

     

<br>



#### RDS의 사용 절차

- RDS를 사용하려면 관리 콘솔에서 RDS 대시보드에 접속하여 인스턴스를 생성해야 한다.

  

- 인스턴스가 생성되면 데이터베이스 클라이언트(관리 도구) 혹은 소프트웨어를 통해 데이터를 입력하고 갱신할 수 있다.

  

- 대부분의 경우 RDS는 EC2에 설치된 소프트웨어와 연동하여 사용해야 한다. 

  - 따라서 EC2와 같은 네트워크에 위치해야 하며 EC2와 연동 작업이 필요하다.

    

  - 또한, EC2, RDS 모두 같은 VPC에 위치해야 한다. 즉, RDS를 구축할 때 RDS와 연동할 EC2와 VPC에 대한 정보를 미리 알아 두면 좋다.

    

- 설계 단계에서 EC2, VPC, RDS에 대한 정보를 잘 정리하여 EC2에 설치한 소프트웨어가 RDS와 연동이 잘 안되는 상황을 피하자.

  

- [자습서](https://aws.amazon.com/ko/getting-started/hands-on/?awsf.getting-started-category=*all&getting-started-all.q=Aurora&getting-started-all.q_operator=AND&awsf.getting-started-level=*all&awsf.getting-started-content-type=*all)를 참조 바란다.



<br>

***

### 키 밸류 데이터베이스: 키를 관리하는 데이터베이스 서비스

![캡처](https://user-images.githubusercontent.com/50399804/134778148-313bc21c-a1d3-4d92-a42e-ac2e5e7f972a.JPG)

- 키 밸류 스토어(key value store) 데이터베이스란 데이터의 형식에 관계없이 어떤 데이터에 대해서 특정 '키'가 되는 값을 결합하여 저장하는 방식의 데이터베이스를 말한다.

  

- RDBMS와 다르게 유연성이 높아 형식에 구애받지 않고, 데이터를 입력할 수 있는 반면, 어떤 것이든 데이터로 저장하므로 상세하게 검색할 수는 없지만 대신 데이터 액세스가 빠르다.

  

- AWS에 키 밸류 스토어 데이터베이스는 두 종류가 있는데 하나는 스토리지에 저장하는 DynamoDB이며, 다른 하나는 메모리에 저장하는 Amazon ElasticCache이다.



<br>



#### Amazon DynamoDB란

- Amazon DynamoDB는 키 밸류 스토어 데이터베이스로 RDBMS에 맞지 않는 범용적 데이터를 저장하는 데 사용한다.

  

- DynamoDB는 VPC가 불필요하므로 Lambda 등과 같은 VPC를 사용하지 않는 애플리케이션 환경과 궁합이 좋다는 장점이 있다.

  

- 대규모 데이터를 처리해야하기 때문에 ACID 트랜잭션, 데이터 암호화, 접근 제한 등의 서비스를 갖추고 있다.

  

- 테이블을 글로벌 테이블로 생성하면 전 세계 각 리전에 분산되어 복제되며, 각 리전의 테이블에 데이터가 갱신됨녀 자동으로 동기화된다.ㄴ



<br>



#### Amazon ElasticCache 란

- Amazon ElasticCache란 인 메모리 데이터베이스이다.

  

- DynamoDB는 스토리지에 저장하기 때문에 인 메모리 데이터베이스인 ElastiCache가 DynamoDB보다 처리 속도가 더 빠르다. 대신 인스턴스를 재시작할 때 데이터가 삭제된다. 따라서 ElastiCache는 빠른 속도를 목적으로 하는 캐시 용도로 많이 사용된다.

  

- ElasticCache에는 Redis 용과 Memcached 용이 있으며 Redis 와 Memcached 는 대표적인 인 메모리형 키 밸류 스토어 DBMS이다. ElasticCache는 이들과 호환할 수 있으며, 현재 사용하고 있는 애플리케이션을 변경하지 않아도 사용할 수 있다.



<br>



#### 그외의 데이터베이스

- Amazon DocumentDB

  - MongoDB 호환 데이터베이스 서비스로 대규모 데이터를 안정적으로 입출력할 수 있도록 설계되었다.

    

  - MongoDB 드라이버와 도구를 사용할 수 있다는 점도 특징이다.

    

  - AWS Database Migration Service를 사용하여 Amazon EC2에서 가동 중인 MongoDB 데이터베이스를 Amazon DocumentDB 로 다운타임 없이 마이그레이션하는 것이 가능하다.

    

- Amazon Neptune

  - 그래프 데이터베이스로, 그래프 데이터란 여러 가지 요소 사이의 관계 혹은 처리의 흐름을 나타내기 때문에 노드의 방향을 포함한 노드 사이의 연결을 기록한 데이터이다.

    

  - Amazon Neptune은 대표적인 그래프 모델인 Property Graph와 W3C의 RDF에서 사용하는 쿼리 언어인 Apache TinkerPop Gremlin과 SPARQL을 지원한다.

    

  - 관리가 자동화되어 있고 네트워크를 통한 데이터의 읽기/쓰기는 HTTPS로 암호화된다.

    

  - 추천 시스템이나 소셜 네트워크, 지식 그래프(지식 기반의 발전된 형태로 정보를 축척할 뿐만 아니라 정보 간의 관련성을 가진 기술) 등에 사용되며 데이터 간의 복잡한 관계를 처리할 수 있다.

    

- Amazon Timestream

  - 시계열 데이터베이스 서비스로, 시간의 경과에 따른 사물의 변화를 기록한 데이터로 전형적인 IoT의 데이터 취득 형태이다.

    

  - 시간별로 취득한 데이터를 RDBMS에 저장하는 것은 가능하지만 집약 및 집계 쿼리를 수행기는 쉽지 않다.

    

  - 쿼리 처리 엔진이 시간별로 처리하는 데 최적화되어 있으며 평활법, 근사, 보간 등의 분석 함수를 사용할 수 있다.

    

  - 자원이 충돌하지 않도록 새로운 데이터를 삽입하고 기존 데이터의 쿼리를 다른 계층에서 처리한다.

    

  - 필요에 따라 스케일링되기 때문에 용량이나 부하를 고려할 필요가 없다.

    

- Amazon Quantum Ledger Databse(QLDB)

  - 장부 데이베이스로 데이터 변경을 추적하여 이력을 남기는 '저널 형식'을 채용하고 있다.

    

  - 저널 데이터는 변경, 삭제가 불가능하며 암호화 해시 함수(SHA-256)에서 변경한 내용을 변조하는 것을 방지하고 있다.

    

  - 한편 SQL과 비슷한 API나 문서 기반 데이터 모델을 제공하며 조작은 쉬운 편이다.

